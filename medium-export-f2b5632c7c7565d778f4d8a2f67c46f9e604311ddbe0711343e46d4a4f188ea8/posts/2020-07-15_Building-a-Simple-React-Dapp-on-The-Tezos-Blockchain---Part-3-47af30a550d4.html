<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Building a Simple React Dapp on The Tezos Blockchain — Part 3</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Building a Simple React Dapp on The Tezos Blockchain — Part 3</h1>
</header>
<section data-field="subtitle" class="p-summary">
NOTE: This is part 3 of a series of posts about how to connect a react webapp to the tezos blockchain. For other posts see:
</section>
<section data-field="body" class="e-content">
<section name="d266" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3105" id="3105" class="graf graf--h3 graf--leading graf--title">Building a Simple React Dapp on The Tezos Blockchain — Part 3</h3><figure name="d3e7" id="d3e7" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*dM2xdjPswrH4-MNwNXeCbg.jpeg" data-width="4500" data-height="4500" src="https://cdn-images-1.medium.com/max/800/1*dM2xdjPswrH4-MNwNXeCbg.jpeg"></figure><p name="3539" id="3539" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">NOTE: This is part 3 of a series of posts about how to connect a react webapp to the tezos blockchain. For other posts see:</em></strong></p><ol class="postList"><li name="56a7" id="56a7" class="graf graf--li graf-after--p"><a href="https://medium.com/tezos-israel/building-a-simple-react-dapp-on-the-tezos-blockchain-part-1-777ff6b0b84e" data-href="https://medium.com/tezos-israel/building-a-simple-react-dapp-on-the-tezos-blockchain-part-1-777ff6b0b84e" class="markup--anchor markup--li-anchor" target="_blank"><em class="markup--em markup--li-em">Part 1 — Bootstrapping</em></a></li><li name="0b57" id="0b57" class="graf graf--li graf-after--li"><a href="https://medium.com/tezos-israel/building-a-simple-react-dapp-on-the-tezos-blockchain-part-2-82ffb3114d5e" data-href="https://medium.com/tezos-israel/building-a-simple-react-dapp-on-the-tezos-blockchain-part-2-82ffb3114d5e" class="markup--anchor markup--li-anchor" target="_blank"><em class="markup--em markup--li-em">Part 2 — Connect to a wallet</em></a></li><li name="51b5" id="51b5" class="graf graf--li graf-after--li"><em class="markup--em markup--li-em">Part 3 — Connect and interact with a contract</em></li></ol><p name="ba17" id="ba17" class="graf graf--p graf-after--li">Complete code for this series is <a href="https://gitlab.com/tezosisrael/demo-tezos-react" data-href="https://gitlab.com/tezosisrael/demo-tezos-react" class="markup--anchor markup--p-anchor" rel="noopener nofollow noopener" target="_blank"><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">here</em></strong></a><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">.</em></strong></p><h3 name="2751" id="2751" class="graf graf--h3 graf-after--p">Connect to Contract:</h3><p name="5a55" id="5a55" class="graf graf--p graf-after--h3">If you didn’t copy the contract address, go into <code class="markup--code markup--p-code">contracts/build/contracts/Counter.json</code>. You&#39;ll see something like this:</p><figure name="7cd6" id="7cd6" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/eb61ee0bd1e1403e3d22c01faaca23b0.js"></script></figure><p name="b80e" id="b80e" class="graf graf--p graf-after--figure">Copy the address value from this file, this is <code class="markup--code markup--p-code">YOUR_CONTRACT_ADDRESS</code>.</p><p name="6b54" id="6b54" class="graf graf--p graf-after--p">Now, let’s create another hook <code class="markup--code markup--p-code">useContract</code> that will connect us to the counter contract.</p><p name="006d" id="006d" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">use-contract.js</code></p><figure name="a336" id="a336" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/d6e2b367415bb93932b29b7574edd59f.js"></script></figure><p name="ec5a" id="ec5a" class="graf graf--p graf-after--figure">Replace <code class="markup--code markup--p-code">YOUR_CONTRACT_ADDRESS</code> with the contract address you copied.</p><p name="c3bc" id="c3bc" class="graf graf--p graf-after--p">What we do here, is to use Taquito to load the contract at the provided address, and then load its storage. We load the storage in this hook and not in another hook because storage is dependent on the contract.</p><p name="0cae" id="0cae" class="graf graf--p graf-after--p">Let’s connect it to see how it works.</p><figure name="0bf0" id="0bf0" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/f557651fb90bf27642c642918188db22.js"></script></figure><p name="58f9" id="58f9" class="graf graf--p graf-after--figure">If you review the code (or even better, write it in your App.js file), you’ll see that we imported the contract hook and used it. The main difference from what we saw until now, is the <code class="markup--code markup--p-code">connect</code> function. Since connectToContract also needs to be called when connecting, we call them both in this function. The order is important because all the settings (network, etc.) are set in the connectToWallet. We might be able to call it in a different function, just to make the calls independent of each other.</p><h3 name="f8a9" id="f8a9" class="graf graf--h3 graf-after--p">Interact with the contract</h3><p name="8f88" id="8f88" class="graf graf--p graf-after--h3">We want the user to be able to increase and decrease the counter. The contract API lets its users increase and decrease any amount, but we will stick to 1.</p><p name="75ab" id="75ab" class="graf graf--p graf-after--p">Let’s implement the increase function first. We will implement it inside the App component, although in a new hook or inside the contract hook is also possible.</p><p name="cd9b" id="cd9b" class="graf graf--p graf-after--p">Bottom of App component (in <code class="markup--code markup--p-code">App.js</code> inside the <code class="markup--code markup--p-code">App</code> function)</p><figure name="724f" id="724f" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/93c660ebb46a8e925406e4057183944c.js"></script></figure><p name="936e" id="936e" class="graf graf--p graf-after--figure">And change the increase button to</p><figure name="46b6" id="46b6" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/68cd2863b6c73b6dbf0613f8c6196709.js"></script></figure><p name="284d" id="284d" class="graf graf--p graf-after--figure">Note that increase calls <code class="markup--code markup--p-code">setOperationError</code> and <code class="markup--code markup--p-code">setOperationLoading</code>, so let&#39;s add them in the upper part of the App component:</p><figure name="b150" id="b150" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/864c76744ba3672dee4786dab2645c90.js"></script></figure><p name="9d41" id="9d41" class="graf graf--p graf-after--figure">And of course, we want to show it in the app, so replace the buttons sections with this:</p><figure name="7de8" id="7de8" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/54cc70080735096103c2180318e18214.js"></script></figure><p name="f732" id="f732" class="graf graf--p graf-after--figure">Note how we set the buttons to be disabled when the operation is loading because we don’t want the user to click a few times.</p><p name="56a8" id="56a8" class="graf graf--p graf-after--p">Let’s see it happening. Go to the browser and click increase (connect again if needed). Since it’s the first operation on the contract we need to reveal it on the chain, so you’ll be asked to permit to operations. Once you agree, a beacon popup will be open, you can close it and see how the app is loading and the buttons are greyed out (disabled). Once the operation is confirmed on-chain, they will be enabled again.</p><h4 name="6d6d" id="6d6d" class="graf graf--h4 graf-after--p">What’s wrong?</h4><p name="a35d" id="a35d" class="graf graf--p graf-after--h4">The counter didn’t change. If you refresh the page and reconnect, you’ll see that it did increase and the account balance is a bit lower then what it was.</p><h4 name="ed3b" id="ed3b" class="graf graf--h4 graf-after--p">Why didn’t it update automatically?</h4><p name="c205" id="c205" class="graf graf--p graf-after--h4">Because we didn’t tell it to. Let’s do that.</p><h3 name="f741" id="f741" class="graf graf--h3 graf-after--p">Auto-sync account balance and contract storage.</h3><p name="356f" id="356f" class="graf graf--p graf-after--h3">Ok, this is the tricky part, I’m pretty sure I’ve got a good solution, but if you think of something else, please let me know.</p><p name="59ad" id="59ad" class="graf graf--p graf-after--p">We want to update the balance and storage when an operation occurs. We can use <code class="markup--code markup--p-code">useEffect</code> for that.</p><p name="8e78" id="8e78" class="graf graf--p graf-after--p">For instance:</p><figure name="1ef4" id="1ef4" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/21d29078a22a3b92f36d9bd6a776889d.js"></script></figure><p name="5431" id="5431" class="graf graf--p graf-after--figure">That’s just pseudocode, as storage is in the contract, and balance is in the account, we will implement them in the different hooks.</p><p name="af0d" id="af0d" class="graf graf--p graf-after--p">Let’s add a counter of the contract operations, this will be the variable through which we track that an operation has been done.</p><p name="62e9" id="62e9" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">useContract</code>:</p><figure name="4b27" id="4b27" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/e3b8438a65acc287f89f6e640143f043.js"></script></figure><h4 name="044f" id="044f" class="graf graf--h4 graf-after--figure">What did we change?</h4><p name="6490" id="6490" class="graf graf--p graf-after--h4">We added the operations counter, and instead of loading the storage when the contract is loaded, we increased the operations counter. With that, we also added a <code class="markup--code markup--p-code">useEffect</code> that is dependent on the counter and contract and calls <code class="markup--code markup--p-code">loadStorage</code> whenever one of its dependencies change.</p><p name="86b4" id="86b4" class="graf graf--p graf-after--p">If you check your app now, it should act the same as before. The difference is that we expose <code class="markup--code markup--p-code">increaseOperationsCount</code> so we can call it inside <code class="markup--code markup--p-code">increase</code> after the confirmation. Let&#39;s do that. Add <code class="markup--code markup--p-code">increaseOperationsCount();</code> after <code class="markup--code markup--p-code">await op.confirmation();</code>.</p><p name="dc9a" id="dc9a" class="graf graf--p graf-after--p">Try your app again, this time the counter should increase by one, but the balance didn’t. That’s because we need to implement the same inside <code class="markup--code markup--p-code">useBalanceState</code>. If you look at your <code class="markup--code markup--p-code">useBalanceState</code> you&#39;ll see that we already have the <code class="markup--code markup--p-code">useEffect</code>, we just need to add a dependency on <code class="markup--code markup--p-code">operationsCount</code>, that means passing it into the hook, and adding it to the dependencies array:</p><figure name="6284" id="6284" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/c8dab09a7329b1dde73c9c26cf449b2b.js"></script></figure><p name="03c6" id="03c6" class="graf graf--p graf-after--figure">In App.js, we need to pass the operationsCount into <code class="markup--code markup--p-code">useBalanceState</code>, that means to move the call to this hook after the call to <code class="markup--code markup--p-code">useContract</code> (because <code class="markup--code markup--p-code">operationsCount</code> comes from <code class="markup--code markup--p-code">useContract</code>). Let&#39;s do that and see if it works.</p><p name="474b" id="474b" class="graf graf--p graf-after--p">The decrease function is almost the same as the increase, so I’ll leave it for you.</p><h3 name="521c" id="521c" class="graf graf--h3 graf-after--p">Wrap up</h3><p name="38d6" id="38d6" class="graf graf--p graf-after--h3">This was just a short (well, at least was supposed to be short) review of how to create a simple react app that interacts with <a href="https://medium.com/u/948dd45fd3d0" data-href="https://medium.com/u/948dd45fd3d0" data-anchor-type="2" data-user-id="948dd45fd3d0" data-action-value="948dd45fd3d0" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user" target="_blank">Tezos</a>.</p><p name="f291" id="f291" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">Note: I ignored a lot of things here, like best practices, security, and more. I am still learning this stuff as I go.</em></p><p name="418f" id="418f" class="graf graf--p graf-after--p">A few things you can do:</p><ul class="postList"><li name="e65e" id="e65e" class="graf graf--li graf-after--p">While writing this I understood that the contract interactions should also be in the contract hook, feel free to refactor and move them there.</li><li name="639e" id="639e" class="graf graf--li graf-after--li">Implement decrease</li><li name="5090" id="5090" class="graf graf--li graf-after--li">Let the user decide the amount to increase/decrease</li><li name="595d" id="595d" class="graf graf--li graf-after--li">Connect automatically when the user opens the app</li><li name="956b" id="956b" class="graf graf--li graf-after--li">Check the repo to see the whole code.</li><li name="6011" id="6011" class="graf graf--li graf-after--li">There’s another contract that comes with truffle examples (actually two, but the migrations contract is used behind the scenes), implement interaction with it.</li><li name="ddb1" id="ddb1" class="graf graf--li graf-after--li">Write me some comments — here or on twitter to <a href="https://twitter.com/chiptus" data-href="https://twitter.com/chiptus" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">@chiptus</a></li><li name="4890" id="4890" class="graf graf--li graf-after--li">read <a href="https://medium.com/u/475fd478604e" data-href="https://medium.com/u/475fd478604e" data-anchor-type="2" data-user-id="475fd478604e" data-action-value="475fd478604e" data-action="show-user-card" data-action-type="hover" class="markup--user markup--li-user" target="_blank">Claude Barde</a>’s <a href="https://medium.com/coinmonks/build-a-tezos-dapp-using-taquito-and-the-beacon-sdk-692d7dc822aa" data-href="https://medium.com/coinmonks/build-a-tezos-dapp-using-taquito-and-the-beacon-sdk-692d7dc822aa" class="markup--anchor markup--li-anchor" target="_blank"><strong class="markup--strong markup--li-strong">post</strong></a> for more info about the implementation</li><li name="7dad" id="7dad" class="graf graf--li graf-after--li">Check Tezos Israel at <a href="https://tezos.co.il" data-href="https://tezos.co.il" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">tezos.co.il</em></strong></a></li></ul><figure name="e3a8" id="e3a8" class="graf graf--figure graf--iframe graf-after--li graf--trailing"><iframe src="https://giphy.com/embed/5YaQLMpqhes0IqtiWw/twitter/iframe" width="435" height="435" frameborder="0" scrolling="no"></iframe></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@chiptus" class="p-author h-card">Chaim Lev-Ari</a> on <a href="https://medium.com/p/47af30a550d4"><time class="dt-published" datetime="2020-07-15T14:22:00.659Z">July 15, 2020</time></a>.</p><p><a href="https://medium.com/@chiptus/building-a-simple-react-dapp-on-the-tezos-blockchain-part-3-47af30a550d4" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 13, 2025.</p></footer></article></body></html>