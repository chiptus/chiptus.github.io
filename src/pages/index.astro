---
import { GithubIcon, LinkedinIcon, MailIcon } from "lucide-react";

import Layout from "../layouts/Layout.astro";
import { Navigation } from "@/components/Navigation";
import { Hero } from "@/components/Hero";
import { WorkExperience } from "@/components/WorkExperience";
import { JourneyTimeline } from "@/components/JourneyTimeline";
import { BeyondCode } from "@/components/BeyondCode";
import { BlogSection } from "@/components/BlogSection";
import { Contact } from "@/components/Contact";
import { Footer } from "@/components/Footer";
import { NowSection } from "@/components/NowSection";
import { Projects } from "@/components/Projects";

import hero from "@/data/hero.json";
import interests from "@/data/interests.json";
import milestones from "@/data/milestones.json";
import now from "@/data/now.json";
import projects from "@/data/projects.json";
import workExperience from "@/data/work-experience.json";
import { getIconComponent } from "@/lib/icon-mapper";

const data = {
  hero,
  interests,
  milestones,
  now,
  projects,
  workExperience,
};

const social = data.hero.social;
const links = social
  ? [
      {
        icon: MailIcon,
        label: "Email",
        value: social.email,
        href: `mailto:${social.email}`,
      },
      {
        icon: GithubIcon,
        label: "GitHub",
        value: social.github.replace("https://", ""),
        href: social.github,
      },
      {
        icon: LinkedinIcon,
        label: "LinkedIn",
        value: social.linkedin.replace("http://", "").replace("https://", ""),
        href: social.linkedin,
      },
    ]
  : [];

// Map icon strings to components
const milestonesWithIcons = data.milestones.map((milestone) => ({
  ...milestone,
  icon: getIconComponent(milestone.icon),
}));

const interestsWithIcons = data.interests.map((interest) => ({
  ...interest,
  icon: getIconComponent(interest.icon),
}));
---

<Layout>
  <div class="min-h-screen">
    <Navigation client:only="react" />
    <main>
      <Hero hero={data.hero} />
      <WorkExperience workExperience={data.workExperience} />
      <JourneyTimeline milestones={milestonesWithIcons} />
      <NowSection now={data.now} />
      <BeyondCode interests={interestsWithIcons} />
      <Projects projects={data.projects} />
      <BlogSection />
      <Contact links={links} social={social} />
    </main>
    <Footer links={links} />
  </div>
</Layout>
